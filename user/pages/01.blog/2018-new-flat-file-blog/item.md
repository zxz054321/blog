---
title: 2018博客开启Flat-File新架构
date: '01-01-2018 00:00'
taxonomy:
    category:
        - blog
author: Abel
---

我的个人网站是从初中时开始建设的，一路走来，从ASP时代的动易（PowerEasy），到PHP时代的帝国CMS、织梦CMS，到更轻型的 Emolog 等博客系统，最终在 WordPress 停留了相当长的一段时间。

WordPress 是一个很成功的博客系统，但历经多年，时代变迁，它的历史包袱是越来越沉重。PHP 5.3 引入的命名空间，是形成现代 PHP 生态的基础。背着兼容性包袱的 WordPress，还用着古老的 PHP 5.2，使得它难以与现代生态接轨，其架构和代码都很有历史感。

此次网站回炉重铸，是为了使网站与现代接轨，同时跟工作实践相互印证。

===

## 选型 / 决策过程

做技术选型不是一件简单的事，首先要根据需求，决定大致的选型方向和范围。

自建独立博客的成本很高，从选购服务器、部署运行环境、开发部署博客程序、长期的服务器运维工作等，全都需要自己来。这远比直接开一个 Medium、CSDN 博客等托管型博客服务麻烦得多，成本也高得多。与此同时，自建博客也很锻炼人，Web 产品的整个生命周期都要自己做一遍。

### 选购服务器

服务器有很多类型，有传统的 VPS，新兴的云服务器，或轻量级的 Docker 容器、应用引擎……我在工作中主要接触云服务器，故选用云服务器。 作为一个长期运行但门可罗雀的博客，成本自然是越低越好。因此选择可免费使用最低配 EC2 的 AWS。

### 部署运行环境

部署运行环境有很多种方式，可以走自动化（Saas 运维服务或运维工具），也可以全手动自己来。自主项目我会使用 Laravel Forge 服务，一键解决部署和运维。但对于个人非商业项目来说，这服务略贵，因此选择手工部署运维。

操作系统选用 Ubuntu Server 16.04 LTS。虽然国内很多运维人员都偏爱 CentOS，但国外开源社区却更爱 Ubuntu。作为开源社区的一员，自然要跟繁荣的开源生态接轨。

运行环境方面，自主项目我会选用经典的 LAMP 组合，后端表现稳定。但因工作中使用 Nginx，选用 LNMP 组合，其中：

- PHP 选用 7.0 版本：为未来迁移自主项目到 Laravel 5.5 LTS（最低要求PHP 7.0）考虑
- MySQL 选用 5.6 版本：为最大兼容性考虑，目前很多环境尚未升级到 MySQL 5.7

### 开发部署博客程序

Grav 是目前 GitHub 上最多 Stars 的 PHP 建站类项目（CMS 或博客系统），比排第二的 OctoberCMS 高了一截。我相信开源社区的力量，能在社区里有如此人气，肯定是有原因的。

近年来，十多年前很繁荣的传统 CMS 都逐渐销声匿迹，比如帝国、织梦、PHPCMS 等，越来越少见。一直以来也没见到成气候的 CMS 系统，新兴的 CMS 系统中，倒是出现了一个新趋势——flat-file CMS。所谓 flat-file，简单来说可以理解成：用文件（而非数据库）来存储数据，可以降低系统的复杂性，做到更灵活轻便。

Grav 基于 PHP 5.5 编写，使用 Compoesr 作依赖管理，并且自己实现了 GPM 插件管理器，命令行操作比较方便。Grav完美融合了现代PHP生态，架构设计也很科学，可轻可重，可傻瓜化使用，也可以自主开发定制。很适合我这种没什么精力去维护，但需求又有点与众不同的小网站。

### 服务器运维

网站刚升级好，有待时间检验……